<!--
doc/src/sgml/ref/pg_amcheck.sgml
PostgreSQL documentation
-->

<refentry id="app-pgamcheck">
<!-- pgdoc-cn_start sig_en=0f948bfdfba5136e295a9fe48de760f3 sig_cn_org=None source=14.1 
 <indexterm zone="app-pgamcheck">
  <primary>pg_amcheck</primary>
 </indexterm>
________________________________________________________-->
 <indexterm zone="app-pgamcheck">
  <primary>pg_amcheck</primary>
 </indexterm>
<!-- pgdoc-cn_end sig_en=0f948bfdfba5136e295a9fe48de760f3 -->

 <refmeta>
  <refentrytitle><application>pg_amcheck</application></refentrytitle>
  <manvolnum>1</manvolnum>
  <refmiscinfo>Application</refmiscinfo>
 </refmeta>

<!-- pgdoc-cn_start sig_en=8f3b779c130d82024f825d37bc414baa sig_cn_org=None source=14.1 
 <refnamediv>
  <refname>pg_amcheck</refname>
  <refpurpose>checks for corruption in one or more
  <productname>PostgreSQL</productname> databases</refpurpose>
 </refnamediv>
________________________________________________________-->
 <refnamediv>
  <refname>pg_amcheck</refname>
  <refpurpose>在一个或多个<productname>PostgreSQL</productname>数据库中检查损坏</refpurpose>
 </refnamediv>
<!-- pgdoc-cn_end sig_en=8f3b779c130d82024f825d37bc414baa -->

 <refsynopsisdiv>
  <cmdsynopsis>
   <command>pg_amcheck</command>
   <arg rep="repeat"><replaceable>option</replaceable></arg>
   <arg><replaceable>dbname</replaceable></arg>
  </cmdsynopsis>
 </refsynopsisdiv>

 <refsect1>
<!-- pgdoc-cn_start sig_en=59d6e86f3a60db4f1e08d0d6e639924e sig_cn_org=None source=14.1 
  <title>Description</title>
________________________________________________________-->
  <title>Description</title>
<!-- pgdoc-cn_end sig_en=59d6e86f3a60db4f1e08d0d6e639924e -->

<!-- pgdoc-cn_start sig_en=e3973922f61b60b5589a7e6fa512d5be sig_cn_org=None source=14.1 
  <para>
   <application>pg_amcheck</application> supports running
   <xref linkend="amcheck"/>'s corruption checking functions against one or
   more databases, with options to select which schemas, tables and indexes to
   check, which kinds of checking to perform, and whether to perform the checks
   in parallel, and if so, the number of parallel connections to establish and
   use.
  </para>
________________________________________________________-->
  <para>
   <application>pg_amcheck</application>支持对一个或多个数据库运行<xref linkend="amcheck"/>的损坏检查函数，并提供选项来选择要检查的模式、表和索引、要执行的检查类型以及是否并行执行检查，如果是，按并行数建立连接并使用。
  </para>
<!-- pgdoc-cn_end sig_en=e3973922f61b60b5589a7e6fa512d5be -->

<!-- pgdoc-cn_start sig_en=69396cca67cf4bf2a0571d05be1140a3 sig_cn_org=0463d1b40eeb0dfb287754a355e7b3d1 source=15.7 
  <para>
   Only ordinary and toast table relations, materialized views, sequences, and
   btree indexes are currently supported.  Other relation types are silently
   skipped.
  </para>
________________________________________________________-->
  <para>
   仅支持普通和toast表关系、物化视图、序列和btree索引。其他关系类型会被静默跳过。
  </para>
<!-- pgdoc-cn_end sig_en=69396cca67cf4bf2a0571d05be1140a3 -->

<!-- pgdoc-cn_start sig_en=8b593fb7210384726a999ea14c13dbd4 sig_cn_org=None source=14.1 
  <para>
   If <literal>dbname</literal> is specified, it should be the name of a
   single database to check, and no other database selection options should
   be present. Otherwise, if any database selection options are present,
   all matching databases will be checked. If no such options are present,
   the default database will be checked. Database selection options include
   <option>-&minus;all</option>, <option>-&minus;database</option> and
   <option>-&minus;exclude-database</option>. They also include
   <option>-&minus;relation</option>, <option>-&minus;exclude-relation</option>,
   <option>-&minus;table</option>, <option>-&minus;exclude-table</option>,
   <option>-&minus;index</option>, and <option>-&minus;exclude-index</option>,
   but only when such options are used with a three-part pattern
   (e.g. <option>mydb*.myschema*.myrel*</option>).  Finally, they include
   <option>-&minus;schema</option> and <option>-&minus;exclude-schema</option>
   when such options are used with a two-part pattern
   (e.g. <option>mydb*.myschema*</option>).
  </para>
________________________________________________________-->
  <para>
   如果指定了<literal>dbname</literal>，则它应该是要检查的单个数据库的名称，并且不应该存在其他数据库选择选项。否则，如果存在任何数据库选择选项，将检查所有匹配的数据库。如果不存在此类选项，将选中默认数据库。数据库选择选项包括<option>--all</option>，<option>--database</option>和<option>--exclude-database</option>。它们还包括<option>--relation</option>，<option>--exclude-relation</option>，
   <option>--table</option>，<option>--exclude-table</option>，<option>--index</option>，和<option>--exclude-index</option>，但仅当这些选项与三段式模式一起使用时（例如，<option>mydb*.myschema*.myrel*</option>）。最后，它们包括<option>--schema</option>和<option>--exclude-schema</option>
当这些选项与两段式模式一起使用时（例如<option>mydb*.myschema*</option>）。
  </para>
<!-- pgdoc-cn_end sig_en=8b593fb7210384726a999ea14c13dbd4 -->

<!-- pgdoc-cn_start sig_en=c1afd5fcfa9c08e320aecef2ef00e8fd sig_cn_org=None source=14.1 
  <para>
   <replaceable>dbname</replaceable> can also be a
   <link linkend="libpq-connstring">connection string</link>.
  </para>
________________________________________________________-->
  <para>
   <replaceable>dbname</replaceable>也可以是一个<link linkend="libpq-connstring">连接字符串</link>.
  </para>
<!-- pgdoc-cn_end sig_en=c1afd5fcfa9c08e320aecef2ef00e8fd -->
 </refsect1>

 <refsect1>
<!-- pgdoc-cn_start sig_en=ee3f399228d18d2103d5b7f4e0aeeba8 sig_cn_org=None source=14.1 
  <title>Options</title>
________________________________________________________-->
  <title>选项</title>
<!-- pgdoc-cn_end sig_en=ee3f399228d18d2103d5b7f4e0aeeba8 -->

<!-- pgdoc-cn_start sig_en=4bf5872a8176ffa7390091f793464b22 sig_cn_org=81268ee76e7ec79ed612f0ceedfd9442 source=15.7 
  <para>
   The following command-line options control what is checked:

   <variablelist>
    <varlistentry>
________________________________________________________-->
  <para>
   以下命令行选项控制要检查的内容：

   <variablelist>
    <varlistentry>
<!-- pgdoc-cn_end sig_en=4bf5872a8176ffa7390091f793464b22 -->
     <term><option>-a</option></term>
     <term><option>--all</option></term>
       <listitem>
<!-- pgdoc-cn_start sig_en=d7c7c1ae856674ae710614834c67bb87 sig_cn_org=332b416635bbea6687b23bc57e58c93c source=15.7 
      <para>
       Check all databases, except for any excluded via
       <option>-&minus;exclude-database</option>.
      </para>
________________________________________________________-->
      <para>
       检查所有数据库，除了通过<option>--exclude-database</option>排除的数据库。
      </para>
<!-- pgdoc-cn_end sig_en=d7c7c1ae856674ae710614834c67bb87 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-d <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--database=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=a8222644cf7ad84e03b4a90d57080c02 sig_cn_org=271e4e5da2380ff723360fdae4488e78 source=15.7 
      <para>
       Check databases matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>,
       except for any excluded by <option>-&minus;exclude-database</option>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       检查与指定的
       <link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>
       匹配的数据库，除了被<option>--exclude-database</option>排除的任何数据库。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=a8222644cf7ad84e03b4a90d57080c02 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-D <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--exclude-database=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=f2f783c31fe916f1ae0ec7d2a96a0d29 sig_cn_org=2a8d027c09718dbbe9cff8f69b5efb3b source=15.7 
      <para>
       Exclude databases matching the given
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       排除与给定的<replaceable class="parameter">模式</replaceable>
       匹配的数据库
       <link linkend="app-psql-patterns">链接</link>。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=f2f783c31fe916f1ae0ec7d2a96a0d29 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-i <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--index=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=89d45af8b21e8f0c9f1b2ede73ff819d sig_cn_org=d8a26ce69fff651a3b33441d0991e7a5 source=15.7 
      <para>
       Check indexes matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>,
       unless they are otherwise excluded.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       检查与指定的
       <link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>
       匹配的索引，除非它们被排除在外。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=89d45af8b21e8f0c9f1b2ede73ff819d -->
<!-- pgdoc-cn_start sig_en=07cdd0d6ea059b70c3e9444d1aae95bc sig_cn_org=93607044da5734af736e544aa39f9d53 source=15.7 
      <para>
       This is similar to the <option>-&minus;relation</option> option, except that
       it applies only to indexes, not to other relation types.
      </para>
________________________________________________________-->
      <para>
       这类似于<option>--relation</option>选项，不同之处在于它仅适用于索引，而不适用于其他关系类型。
      </para>
<!-- pgdoc-cn_end sig_en=07cdd0d6ea059b70c3e9444d1aae95bc -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-I <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--exclude-index=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=981cc5a106f55be24fdcc19629acc4c3 sig_cn_org=e9445b2d624127288ab0b8b911be9cf9 source=15.7 
      <para>
       Exclude indexes matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       排除与指定的<link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>匹配的索引。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=981cc5a106f55be24fdcc19629acc4c3 -->
<!-- pgdoc-cn_start sig_en=ef3a9e34ec54a02ff68756b73c6fffcb sig_cn_org=5cfc30d9679fb85f4c6c88d153e3eb4f source=15.7 
      <para>
       This is similar to the <option>-&minus;exclude-relation</option> option,
       except that it applies only to indexes, not other relation types.
      </para>
________________________________________________________-->
      <para>
       这类似于<option>--exclude-relation</option>选项，只适用于索引，而不适用于其他关系类型。
      </para>
<!-- pgdoc-cn_end sig_en=ef3a9e34ec54a02ff68756b73c6fffcb -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-r <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--relation=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=b09dd7beafd3a743a3e879dafbf4b607 sig_cn_org=05d15a8c0a418852d41f1c976a9ee918 source=15.7 
      <para>
       Check relations matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>,
       unless they are otherwise excluded.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       检查与指定的
       <link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>
       匹配的关系，除非它们被排除在外。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=b09dd7beafd3a743a3e879dafbf4b607 -->
<!-- pgdoc-cn_start sig_en=2e5c69ba06f628ccf72c4a7a2a44d93c sig_cn_org=cc4762160424120ab6299ad15db22ca8 source=15.7 
      <para>
       Patterns may be unqualified, e.g. <literal>myrel*</literal>, or they
       may be schema-qualified, e.g. <literal>myschema*.myrel*</literal> or
       database-qualified and schema-qualified, e.g.
       <literal>mydb*.myschema*.myrel*</literal>. A database-qualified
       pattern will add matching databases to the list of databases to be
       checked.
      </para>
________________________________________________________-->
      <para>
       模式可以是未经限定的，例如<literal>myrel*</literal>，也可以是经过模式限定的，例如<literal>myschema*.myrel*</literal>或者数据库限定和模式限定的，例如<literal>mydb*.myschema*.myrel*</literal>。数据库限定的模式将会将匹配的数据库添加到待检查的数据库列表中。
      </para>
<!-- pgdoc-cn_end sig_en=2e5c69ba06f628ccf72c4a7a2a44d93c -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-R <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--exclude-relation=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=b51bd5c50861c31bad56d4fec5516d27 sig_cn_org=65c1e45c638a0ee75b5f185d8113f5db source=15.7 
      <para>
       Exclude relations matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       排除与指定的<link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>匹配的关系。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=b51bd5c50861c31bad56d4fec5516d27 -->
<!-- pgdoc-cn_start sig_en=ce0d1a65fac1b0e8cbaf0ef5389e42f1 sig_cn_org=a9412132d406b8003fac5e426fbdcf3b source=15.7 
      <para>
       As with <option>-&minus;relation</option>, the
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link> may be unqualified, schema-qualified,
       or database- and schema-qualified.
      </para>
________________________________________________________-->
      <para>
       与<option>--relation</option>一样，<link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>可以是未经限定的，模式限定的，
       或数据库和模式限定的。
      </para>
<!-- pgdoc-cn_end sig_en=ce0d1a65fac1b0e8cbaf0ef5389e42f1 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-s <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--schema=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=e9b279b47f43f0a2f20b6c7d33d1eb0c sig_cn_org=e9e698fa4c186f815cba0f49b204a8ed source=15.7 
      <para>
       Check tables and indexes in schemas matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>, unless they are otherwise excluded.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       检查与指定的<link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>匹配的模式中的表和索引，除非它们被排除在外。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=e9b279b47f43f0a2f20b6c7d33d1eb0c -->
<!-- pgdoc-cn_start sig_en=18e1e017ff582196d6471ac43aa2b43b sig_cn_org=02e0dc20697b73d32ecbc2886e3ff030 source=15.7 
      <para>
       To select only tables in schemas matching a particular pattern,
       consider using something like
       <literal>-&minus;table=SCHEMAPAT.* -&minus;no-dependent-indexes</literal>.
       To select only indexes, consider using something like
       <literal>-&minus;index=SCHEMAPAT.*</literal>.
      </para>
________________________________________________________-->
      <para>
       要选择仅匹配特定模式的模式中的表，
       可考虑使用类似以下内容
       <literal>--table=SCHEMAPAT.* --no-dependent-indexes</literal>。
       要选择仅索引，可考虑使用类似以下内容
       <literal>--index=SCHEMAPAT.*</literal>。
      </para>
<!-- pgdoc-cn_end sig_en=18e1e017ff582196d6471ac43aa2b43b -->
<!-- pgdoc-cn_start sig_en=ee17f74cfa3fa297d8d2909025c63de5 sig_cn_org=389e27c1ad634dc8b75dbf7d0c30dc0f source=15.7 
      <para>
       A schema pattern may be database-qualified. For example, you may
       write <literal>-&minus;schema=mydb*.myschema*</literal> to select
       schemas matching <literal>myschema*</literal> in databases matching
       <literal>mydb*</literal>.
      </para>
________________________________________________________-->
      <para>
       模式模式可以是数据库限定的。例如，您可以编写<literal>--schema=mydb*.myschema*</literal>来选择与<literal>myschema*</literal>匹配的模式，在匹配的数据库中选择<literal>mydb*</literal>。
      </para>
<!-- pgdoc-cn_end sig_en=ee17f74cfa3fa297d8d2909025c63de5 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-S <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--exclude-schema=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=0bbdf2e59739573400e0a71551a83f96 sig_cn_org=e6b9d1e272be8303ee395b5f3e4187b9 source=15.7 
      <para>
       Exclude tables and indexes in schemas matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       排除与指定的
       <link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>
       匹配的模式和索引。此选项可以指定多次。
      </para>
<!-- pgdoc-cn_end sig_en=0bbdf2e59739573400e0a71551a83f96 -->
<!-- pgdoc-cn_start sig_en=ce21764819f63f47916d9a71cbb4a6a8 sig_cn_org=29f95b0b134f1d777790230597a5f6ea source=15.7 
      <para>
       As with <option>-&minus;schema</option>, the pattern may be
       database-qualified.
      </para>
________________________________________________________-->
      <para>
       与<option>--schema</option>选项一样，该模式可能是数据库限定的。
      </para>
<!-- pgdoc-cn_end sig_en=ce21764819f63f47916d9a71cbb4a6a8 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-t <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--table=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=5605d02ab85d1206134b087080389d29 sig_cn_org=eb02da9d23221747675e8753d2de5533 source=15.7 
      <para>
       Check tables matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>,
       unless they are otherwise excluded.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       检查匹配指定<link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>的表，
       除非它们被排除在外。
       可以多次指定此选项。
      </para>
<!-- pgdoc-cn_end sig_en=5605d02ab85d1206134b087080389d29 -->
<!-- pgdoc-cn_start sig_en=f16ddd8e3441828655db0f1bfdbf748e sig_cn_org=6314931097e0264ffec01b98877fe612 source=15.7 
      <para>
       This is similar to the <option>-&minus;relation</option> option, except that
       it applies only to tables, materialized views, and sequences, not to
       indexes.
      </para>
________________________________________________________-->
      <para>
       这类似于<option>--relation</option>选项，不同之处在于它仅适用于表、物化视图和序列，而不适用于索引。
      </para>
<!-- pgdoc-cn_end sig_en=f16ddd8e3441828655db0f1bfdbf748e -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-T <replaceable class="parameter">pattern</replaceable></option></term>
     <term><option>--exclude-table=<replaceable class="parameter">pattern</replaceable></option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=7b7d8f60f2126eb179b495b859b3510f sig_cn_org=a8577e8cddc349d8ca7ce7cb7aab38d8 source=15.7 
      <para>
       Exclude tables matching the specified
       <link linkend="app-psql-patterns"><replaceable class="parameter">pattern</replaceable></link>.
       This option can be specified more than once.
      </para>
________________________________________________________-->
      <para>
       排除与指定的
       <link linkend="app-psql-patterns"><replaceable class="parameter">模式</replaceable></link>
       匹配的表。此选项可以指定多次。
      </para>
<!-- pgdoc-cn_end sig_en=7b7d8f60f2126eb179b495b859b3510f -->
<!-- pgdoc-cn_start sig_en=e263f6ec4821190061b0aa91d58e8ac2 sig_cn_org=d1f0aefea7309885411ee7ee168b205f source=15.7 
      <para>
       This is similar to the <option>-&minus;exclude-relation</option> option,
       except that it applies only to tables, materialized views, and
       sequences, not to indexes.
      </para>
________________________________________________________-->
      <para>
       这类似于<option>--exclude-relation</option>选项，只适用于表、物化视图和序列，而不适用于索引。
      </para>
<!-- pgdoc-cn_end sig_en=e263f6ec4821190061b0aa91d58e8ac2 -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--no-dependent-indexes</option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=c3898b50de9e83d4382b75ba95279b6a sig_cn_org=60faf78527263fc4c7bc2e78a170e413 source=15.7 
      <para>
       By default, if a table is checked, any btree indexes of that table
       will also be checked, even if they are not explicitly selected by
       an option such as <literal>-&minus;index</literal> or
       <literal>-&minus;relation</literal>. This option suppresses that behavior.
      </para>
________________________________________________________-->
      <para>
       默认情况下，如果检查一个表，那么该表的任何btree索引也将被检查，即使它们没有被显式选择，
       比如<literal>--index</literal>或<literal>--relation</literal>选项。此选项抑制了该行为。
      </para>
<!-- pgdoc-cn_end sig_en=c3898b50de9e83d4382b75ba95279b6a -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--no-dependent-toast</option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=e4f84e41a9af09f99db66ec2a11b8ebc sig_cn_org=d40a45aaaabbffbc65094c9e203cdba1 source=15.7 
      <para>
       By default, if a table is checked, its toast table, if any, will also
       be checked, even if it is not explicitly selected by an option
       such as <literal>-&minus;table</literal> or <literal>-&minus;relation</literal>.
       This option suppresses that behavior.
      </para>
________________________________________________________-->
      <para>
       默认情况下，如果检查一个表，它的toast表（如果有的话）也会被检查，即使它没有被选中，
       例如<literal>--table</literal>或<literal>--relation</literal>选项。这个选项抑制了这种行为。
      </para>
<!-- pgdoc-cn_end sig_en=e4f84e41a9af09f99db66ec2a11b8ebc -->
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--no-strict-names</option></term>
     <listitem>
<!-- pgdoc-cn_start sig_en=597a28f7a543c2152c830d1490d3b018 sig_cn_org=69aedc61fb8291d8947c14ae1efe2494 source=15.7 
      <para>
       By default, if an argument to <literal>-&minus;database</literal>,
       <literal>-&minus;table</literal>, <literal>-&minus;index</literal>,
       or <literal>-&minus;relation</literal> matches no objects, it is a fatal
       error. This option downgrades that error to a warning.
      </para>
________________________________________________________-->
      <para>
       默认情况下，如果<literal>--database</literal>、<literal>--table</literal>、
       <literal>--index</literal>或<literal>--relation</literal>的参数与任何对象都不匹配，
       那么这将是一个致命错误。此选项将该错误降级为警告。
      </para>
<!-- pgdoc-cn_end sig_en=597a28f7a543c2152c830d1490d3b018 -->
     </listitem>
    </varlistentry>
   </variablelist>
  </para>

<!-- pgdoc-cn_start sig_en=6f8ffec43f00bc5367346ed5d76e8d41 sig_cn_org=None source=14.1 
  <para>
   The following command-line options control checking of tables:

   <variablelist>
    <varlistentry>
     <term><option>-&minus;exclude-toast-pointers</option></term>
     <listitem>
      <para>
       By default, whenever a toast pointer is encountered in a table,
       a lookup is performed to ensure that it references apparently-valid
       entries in the toast table. These checks can be quite slow, and this
       option can be used to skip them.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;on-error-stop</option></term>
     <listitem>
      <para>
       After reporting all corruptions on the first page of a table where
       corruption is found, stop processing that table relation and move on
       to the next table or index.
      </para>
      <para>
       Note that index checking always stops after the first corrupt page.
       This option only has meaning relative to table relations.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;skip=<replaceable class="parameter">option</replaceable></option></term>
     <listitem>
      <para>
       If <literal>all-frozen</literal> is given, table corruption checks
       will skip over pages in all tables that are marked as all frozen.
      </para>
      <para>
       If <literal>all-visible</literal> is given, table corruption checks
       will skip over pages in all tables that are marked as all visible.
      </para>
      <para>
       By default, no pages are skipped.  This can be specified as
       <literal>none</literal>, but since this is the default, it need not be
       mentioned.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;startblock=<replaceable class="parameter">block</replaceable></option></term>
     <listitem>
      <para>
       Start checking at the specified block number. An error will occur if
       the table relation being checked has fewer than this number of blocks.
       This option does not apply to indexes, and is probably only useful
       when checking a single table relation. See <literal>-&minus;endblock</literal>
       for further caveats.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;endblock=<replaceable class="parameter">block</replaceable></option></term>
     <listitem>
      <para>
       End checking at the specified block number.  An error will occur if the
       table relation being checked has fewer than this number of blocks.
       This option does not apply to indexes, and is probably only useful when
       checking a single table relation. If both a regular table and a toast
       table are checked, this option will apply to both, but higher-numbered
       toast blocks may still be accessed while validating toast pointers,
       unless that is suppressed using
       <option>-&minus;exclude-toast-pointers</option>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
________________________________________________________-->
  <para>
   以下命令行选项用于控制表的检查：

   <variablelist>
    <varlistentry>
     <term><option>--exclude-toast-pointers</option></term>
     <listitem>
      <para>
       默认情况下，每当在表中遇到toast指针时，都会执行查找以确保它引用toast表中明显有效的条目。这些检查可能非常慢，可以使用此选项跳过这些检查。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--on-error-stop</option></term>
     <listitem>
      <para>
       在发现损坏的表的第一页上报告所有损坏后，停止处理该表关系，并转到下一个表或索引。
      </para>
      <para>
       请注意，索引检查总是在第一个损坏页之后停止。此选项仅与表关系相关。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--skip=<replaceable class="parameter">option</replaceable></option></term>
     <listitem>
      <para>
       如果给定<literal>all-frozen</literal>，表损坏检查将跳过所有表中标记为全部冻结的页面。
      </para>
      <para>
       如果给定了<literal>all-visible</literal>，则表损坏检查将跳过所有表中标记为所有可见的页面。
      </para>
      <para>
       默认情况下，不跳过任何页面。这可以指定为<literal>none</literal>，但由于这是默认值，因此无需提及。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--startblock=<replaceable class="parameter">block</replaceable></option></term>
     <listitem>
      <para>
       从指定的块号开始检查。如果正在检查的表关系的块数少于此数，则会发生错误。此选项不适用于索引，可能仅在检查单个表关系时有用。请参阅<literal>--endblock</literal>了解更多注意事项。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--endblock=<replaceable class="parameter">block</replaceable></option></term>
     <listitem>
      <para>
       在指定的块号结束检查。如果正在检查的表关系的块数少于此数，则会发生错误。此选项不适用于索引，可能仅在检查单个表关系时有用。如果同时选中常规表和toast表，则此选项将同时适用于这两个表，但在验证toast指针时，仍然可以访问编号更高的toast块，除非使用<option>--exclude-toast-pointers</option>抑制。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
<!-- pgdoc-cn_end sig_en=6f8ffec43f00bc5367346ed5d76e8d41 -->

<!-- pgdoc-cn_start sig_en=684221b40b944d1c46bf90a5451ac2a4 sig_cn_org=None source=14.1 
  <para>
   The following command-line options control checking of B-tree indexes:

   <variablelist>
    <varlistentry>
     <term><option>-&minus;heapallindexed</option></term>
     <listitem>
      <para>
       For each index checked, verify the presence of all heap tuples as index
       tuples in the index using <xref linkend="amcheck"/>'s
       <option>heapallindexed</option> option.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;parent-check</option></term>
     <listitem>
      <para>
       For each btree index checked, use <xref linkend="amcheck"/>'s
       <function>bt_index_parent_check</function> function, which performs
       additional checks of parent/child relationships during index checking.
      </para>
      <para>
       The default is to use <application>amcheck</application>'s
       <function>bt_index_check</function> function, but note that use of the
       <option>-&minus;rootdescend</option> option implicitly selects
       <function>bt_index_parent_check</function>.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;rootdescend</option></term>
     <listitem>
      <para>
       For each index checked, re-find tuples on the leaf level by performing a
       new search from the root page for each tuple using
       <xref linkend="amcheck"/>'s <option>rootdescend</option> option.
      </para>
      <para>
       Use of this option implicitly also selects the
       <option>-&minus;parent-check</option> option.
      </para>
      <para>
       This form of verification was originally written to help in the
       development of btree index features.  It may be of limited use or even
       of no use in helping detect the kinds of corruption that occur in
       practice.  It may also cause corruption checking to take considerably
       longer and consume considerably more resources on the server.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
________________________________________________________-->
  <para>
   以下命令行选项用来控制B树索引的检查：

   <variablelist>
    <varlistentry>
     <term><option>--heapallindexed</option></term>
     <listitem>
      <para>
       对于每个选中的索引，使用<xref linkend="amcheck"/>'s
       <option>heapallindexed</option>选项验证索引中是否存在作为索引元组的所有堆元组。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--parent-check</option></term>
     <listitem>
      <para>
       对于检查的每个btree索引，使用<xref linkend="amcheck"/>的<function>bt_index_parent_check</function>函数，该函数在索引检查期间对父/子关系执行其他检查。
      </para>
      <para>
       默认情况是使用<application>amcheck</application>的<function>bt_index_check</function>函数，但请注意，使用<option>--rootdescend</option>选项会隐式选择<function>bt_index_parent_check</function>。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--rootdescend</option></term>
     <listitem>
      <para>
       对于每个选中的索引，通过使用<xref linkend="amcheck"/>'s <option>rootdescend</option>选项从根页面对每个元组执行新搜索，在叶级重新查找元组。
      </para>
      <para>
       使用此选项也会隐式选择<option>--parent-check</option>选项。
      </para>
      <para>
       这种形式的验证最初是为了帮助开发btree索引功能而编写的。它在帮助检测实践中发生的损坏类型方面可能用处有限，甚至毫无用处。它还可能导致损坏检查花费相当长的时间，并消耗服务器上相当多的资源。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
<!-- pgdoc-cn_end sig_en=684221b40b944d1c46bf90a5451ac2a4 -->

  <warning>
<!-- pgdoc-cn_start sig_en=afc0e63da7891c31f527c84dcdea8d67 sig_cn_org=None source=14.1 
   <para>
    The extra checks performed against B-tree indexes when the
    <option>-&minus;parent-check</option> option or the
    <option>-&minus;rootdescend</option> option is specified require
    relatively strong relation-level locks.  These checks are the only
    checks that will block concurrent data modification from
    <command>INSERT</command>, <command>UPDATE</command>, and
    <command>DELETE</command> commands.
   </para>
________________________________________________________-->
   <para>
    当指定<option>--parent-check</option>选项或<option>--rootdescend</option>选项时，对B树索引执行的额外检查需要相对强的关系级锁。这些检查是唯一会阻止<command>INSERT</command>，<command>UPDATE</command>，和<command>DELETE</command>命令并发数据修改的检查。
   </para>
<!-- pgdoc-cn_end sig_en=afc0e63da7891c31f527c84dcdea8d67 -->
  </warning>

<!-- pgdoc-cn_start sig_en=76a5088a0c5daa8dee22c940af6cc36c sig_cn_org=None source=14.1 
  <para>
   The following command-line options control the connection to the server:

   <variablelist>
    <varlistentry>
     <term><option>-h <replaceable class="parameter">hostname</replaceable></option></term>
     <term><option>-&minus;host=<replaceable class="parameter">hostname</replaceable></option></term>
     <listitem>
      <para>
       Specifies the host name of the machine on which the server is running.
       If the value begins with a slash, it is used as the directory for the
       Unix domain socket.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
     <term><option>-&minus;port=<replaceable class="parameter">port</replaceable></option></term>
     <listitem>
      <para>
       Specifies the TCP port or local Unix domain socket file extension on
       which the server is listening for connections.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-U</option></term>
     <term><option>-&minus;username=<replaceable class="parameter">username</replaceable></option></term>
     <listitem>
      <para>
       User name to connect as.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-w</option></term>
     <term><option>-&minus;no-password</option></term>
     <listitem>
      <para>
       Never issue a password prompt.  If the server requires password
       authentication and a password is not available by other means such as
       a <filename>.pgpass</filename> file, the connection attempt will fail.
       This option can be useful in batch jobs and scripts where no user is
       present to enter a password.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-W</option></term>
     <term><option>-&minus;password</option></term>
     <listitem>
      <para>
       Force <application>pg_amcheck</application> to prompt for a password
       before connecting to a database.
      </para>
      <para>
       This option is never essential, since
       <application>pg_amcheck</application> will automatically prompt for a
       password if the server demands password authentication.  However,
       <application>pg_amcheck</application> will waste a connection attempt
       finding out that the server wants a password.  In some cases it is
       worth typing <option>-W</option> to avoid the extra connection attempt.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;maintenance-db=<replaceable class="parameter">dbname</replaceable></option></term>
     <listitem>
      <para>
       Specifies a database or
       <link linkend="libpq-connstring">connection string</link> to be
       used to discover the list of databases to be checked. If neither
       <option>-&minus;all</option> nor any option including a database pattern is
       used, no such connection is required and this option does nothing.
       Otherwise, any connection string parameters other than
       the database name which are included in the value for this option
       will also be used when connecting to the databases
       being checked. If this option is omitted, the default is
       <literal>postgres</literal> or, if that fails,
       <literal>template1</literal>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
________________________________________________________-->
  <para>
   以下命令行选项用来控制与服务器的连接：

   <variablelist>
    <varlistentry>
     <term><option>-h <replaceable class="parameter">hostname</replaceable></option></term>
     <term><option>--host=<replaceable class="parameter">hostname</replaceable></option></term>
     <listitem>
      <para>
       指定运行服务器的计算机的主机名。如果该值以斜杠开头，它将用作Unix域套接字的目录。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-p <replaceable class="parameter">port</replaceable></option></term>
     <term><option>--port=<replaceable class="parameter">port</replaceable></option></term>
     <listitem>
      <para>
       指定服务器正在侦听连接的TCP端口或本地Unix域套接字文件扩展名。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-U</option></term>
     <term><option>--username=<replaceable class="parameter">username</replaceable></option></term>
     <listitem>
      <para>
       连接的用户名。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-w</option></term>
     <term><option>--no-password</option></term>
     <listitem>
      <para>
       永远不要发出密码提示。如果服务器需要密码身份验证，并且密码无法通过其他方式（如<filename>.pgpass</filename>文件，连接尝试将失败。在没有用户输入密码的批处理作业和脚本中，此选项非常有用。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-W</option></term>
     <term><option>--password</option></term>
     <listitem>
      <para>
       在连接到数据库之前，强制<application>pg_amcheck</application>提示输入密码。
      </para>
      <para>
       此选项从来都不是必需的，因为如果服务器要求密码身份验证，<application>pg_amcheck</application>将自动提示输入密码。但是，<application>pg_amcheck</application>将浪费一次连接尝试，以发现服务器需要密码。在某些情况下，键入<option>-W</option>以避免额外的连接尝试是值得的。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--maintenance-db=<replaceable class="parameter">dbname</replaceable></option></term>
     <listitem>
      <para>
       指定用于发现要检查的数据库列表的数据库或<link linkend="libpq-connstring">连接字符串</link>。如果既不使用<option>--all</option>也不使用任何包含数据库模式的选项，则不需要这种连接，并且该选项不起任何作用。否则，连接到正在检查的数据库时，也将使用此选项值中包含的数据库名称以外的任何连接字符串参数。如果省略此选项，则默认值为<literal>postgres</literal>，或如果失败，则为<literal>template1</literal>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
<!-- pgdoc-cn_end sig_en=76a5088a0c5daa8dee22c940af6cc36c -->

<!-- pgdoc-cn_start sig_en=b073bdf8d22ca108b5069990f63d6bfb sig_cn_org=None source=14.1 
  <para>
   Other options are also available:

   <variablelist>
    <varlistentry>
     <term><option>-e</option></term>
     <term><option>-&minus;echo</option></term>
     <listitem>
      <para>
      Echo to stdout all SQL sent to the server.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-j <replaceable class="parameter">num</replaceable></option></term>
     <term><option>-&minus;jobs=<replaceable class="parameter">num</replaceable></option></term>
     <listitem>
      <para>
       Use <replaceable>num</replaceable> concurrent connections to the server,
       or one per object to be checked, whichever is less.
      </para>
      <para>
       The default is to use a single connection.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-P</option></term>
     <term><option>-&minus;progress</option></term>
     <listitem>
      <para>
       Show progress information. Progress information includes the number
       of relations for which checking has been completed, and the total
       size of those relations. It also includes the total number of relations
       that will eventually be checked, and the estimated size of those
       relations.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-v</option></term>
     <term><option>-&minus;verbose</option></term>
     <listitem>
      <para>
       Print more messages. In particular, this will print a message for
       each relation being checked, and will increase the level of detail
       shown for server errors.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-V</option></term>
     <term><option>-&minus;version</option></term>
     <listitem>
      <para>
       Print the <application>pg_amcheck</application> version and exit.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-&minus;install-missing</option></term>
     <term><option>-&minus;install-missing=<replaceable class="parameter">schema</replaceable></option></term>
     <listitem>
      <para>
       Install any missing extensions that are required to check the
       database(s).  If not yet installed, each extension's objects will be
       installed into the given
       <replaceable class="parameter">schema</replaceable>, or if not specified
       into schema <literal>pg_catalog</literal>.
      </para>
      <para>
       At present, the only required extension is <xref linkend="amcheck"/>.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-?</option></term>
     <term><option>-&minus;help</option></term>
     <listitem>
      <para>
       Show help about <application>pg_amcheck</application> command line
       arguments, and exit.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
________________________________________________________-->
  <para>
   其它允许的选项：

   <variablelist>
    <varlistentry>
     <term><option>-e</option></term>
     <term><option>--echo</option></term>
     <listitem>
      <para>
      回显发送到服务器的所有SQL。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-j <replaceable class="parameter">num</replaceable></option></term>
     <term><option>--jobs=<replaceable class="parameter">num</replaceable></option></term>
     <listitem>
      <para>
       使用<replaceable>num</replaceable>个到服务器的并发连接，或每个要检查的对象使用一个连接，以较小者为准。
      </para>
      <para>
       默认情况是使用单个连接。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-P</option></term>
     <term><option>--progress</option></term>
     <listitem>
      <para>
       显示进度信息。进度信息包括已完成检查的关系数以及这些关系的总大小。它还包括最终要检查的关系的总数，以及这些关系的估计大小。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-v</option></term>
     <term><option>--verbose</option></term>
     <listitem>
      <para>
       打印更多消息。特别是，这将为每个正在检查的关系打印一条消息，并将增加服务器错误的详细程度。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-V</option></term>
     <term><option>--version</option></term>
     <listitem>
      <para>
       打印<application>pg_amcheck</application>版本并退出。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>--install-missing</option></term>
     <term><option>--install-missing=<replaceable class="parameter">schema</replaceable></option></term>
     <listitem>
      <para>
       安装检查数据库所需的任何缺少的扩展。如果尚未安装，每个扩展的对象将安装到给定的<replaceable class="parameter">schema</replaceable>中，或者如果未指定则安装到<literal>pg_catalog</literal>模式中。
      </para>
      <para>
       目前，唯一需要的扩展是<xref linkend="amcheck"/>。
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term><option>-?</option></term>
     <term><option>--help</option></term>
     <listitem>
      <para>
       显示有关<application>pg_amcheck</application>命令行参数的帮助，然后退出。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
<!-- pgdoc-cn_end sig_en=b073bdf8d22ca108b5069990f63d6bfb -->
 </refsect1>

 <refsect1>
<!-- pgdoc-cn_start sig_en=c44fa43baeb4f69a8a2aa1ea108c6e97 sig_cn_org=None source=14.1 
  <title>Notes</title>
________________________________________________________-->
  <title>Notes</title>
<!-- pgdoc-cn_end sig_en=c44fa43baeb4f69a8a2aa1ea108c6e97 -->

<!-- pgdoc-cn_start sig_en=c290e48ab1c0978a9787ec03f24b3fd8 sig_cn_org=None source=14.1 
  <para>
   <application>pg_amcheck</application> is designed to work with
   <productname>PostgreSQL</productname> 14.0 and later.
  </para>
________________________________________________________-->
  <para>
   <application>pg_amcheck</application>被设计运行于
   <productname>PostgreSQL</productname> 14.0及以上版本。
  </para>
<!-- pgdoc-cn_end sig_en=c290e48ab1c0978a9787ec03f24b3fd8 -->
 </refsect1>

 <refsect1>
<!-- pgdoc-cn_start sig_en=8b7cc214676b443e6527e3d6bf054420 sig_cn_org=None source=14.1 
  <title>See Also</title>
________________________________________________________-->
  <title>See Also</title>
<!-- pgdoc-cn_end sig_en=8b7cc214676b443e6527e3d6bf054420 -->

  <simplelist type="inline">
   <member><xref linkend="amcheck"/></member>
  </simplelist>
 </refsect1>
</refentry>
