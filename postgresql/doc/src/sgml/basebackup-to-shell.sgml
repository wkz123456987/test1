<!-- doc/src/sgml/basebackup-to-shell.sgml -->

<sect1 id="basebackup-to-shell" xreflabel="basebackup_to_shell">
<!-- pgdoc-cn_start sig_en=f3aad9551d5f3a8b5af929f09a0266f1 sig_cn_org=f3aad9551d5f3a8b5af929f09a0266f1 source=15.7 
 <title>basebackup_to_shell</title>
________________________________________________________-->
 <title>basebackup_to_shell</title>
<!-- pgdoc-cn_end sig_en=f3aad9551d5f3a8b5af929f09a0266f1 -->

<!-- pgdoc-cn_start sig_en=89d816950f5abdec096f0bb9046816d3 sig_cn_org=d6e2696af8b714c9974ff13d60b796b7 source=15.7 
 <indexterm zone="basebackup-to-shell">
  <primary>basebackup_to_shell</primary>
 </indexterm>
________________________________________________________-->
 <indexterm zone="basebackup-to-shell">
  <primary>basebackup_to_shell</primary>
 </indexterm>
<!-- pgdoc-cn_end sig_en=89d816950f5abdec096f0bb9046816d3 -->

<!-- pgdoc-cn_start sig_en=0285e6d540c105dcdec4b7a8008a4746 sig_cn_org=b9b72db46ea5e6086eab521a06e98ba3 source=15.7 
 <para>
  <filename>basebackup_to_shell</filename> adds a custom basebackup target
  called <literal>shell</literal>. This makes it possible to run
  <command>pg_basebackup -&minus;target=shell</command> or, depending on how this
  module is configured,
  <command>pg_basebackup -&minus;target=shell:<replaceable>DETAIL_STRING</replaceable></command>,
  and cause a server command chosen by the server administrator to be executed
  for each tar archive generated by the backup process. The command will receive
  the contents of the archive via standard input.
 </para>
________________________________________________________-->
 <para>
  <filename>basebackup_to_shell</filename> 添加了一个名为<literal>shell</literal>的自定义basebackup目标。这使得可以运行<command>pg_basebackup --target=shell</command>或者，取决于模块的配置方式，<command>pg_basebackup --target=shell:<replaceable>DETAIL_STRING</replaceable></command>，并导致由服务器管理员选择的服务器命令在备份过程生成的每个tar归档中被执行。该命令将通过标准输入接收归档的内容。
</para>
<!-- pgdoc-cn_end sig_en=0285e6d540c105dcdec4b7a8008a4746 -->

<!-- pgdoc-cn_start sig_en=44124e2aa2fbd844d0570e0ba5d4e900 sig_cn_org=1ff5e6d7498738f6821bcee2ccfe59e6 source=15.7 
 <para>
  This module is primarily intended as an example of how to create a new
  backup targets via an extension module, but in some scenarios it may be
  useful for its own sake.
  In order to function, this module must be loaded via
  <xref linkend="guc-shared-preload-libraries"/> or
  <xref linkend="guc-local-preload-libraries"/>.
 </para>
________________________________________________________-->
 <para>
  本模块主要是作为通过扩展模块创建新的备份目标的示例，但在某些情况下，它可能
  也有自身的用途。
  为了使其正常工作，必须通过<xref linkend="guc-shared-preload-libraries"/>或
  <xref linkend="guc-local-preload-libraries"/>加载此模块。
</para>
<!-- pgdoc-cn_end sig_en=44124e2aa2fbd844d0570e0ba5d4e900 -->

 <sect2>
<!-- pgdoc-cn_start sig_en=9125daac1844cde69a678e3c3c9c9bcf sig_cn_org=None source=14.1 
  <title>Configuration Parameters</title>
________________________________________________________-->
  <title>配置参数</title>
<!-- pgdoc-cn_end sig_en=9125daac1844cde69a678e3c3c9c9bcf -->

  <variablelist>
   <varlistentry>
<!-- pgdoc-cn_start sig_en=f1ba6020d37f05ba7c3dbc0c060a23d8 sig_cn_org=5a906d34175164a485e447f3e9c79dd5 source=15.7 
    <term>
     <varname>basebackup_to_shell.command</varname> (<type>string</type>)
     <indexterm>
      <primary><varname>basebackup_to_shell.command</varname> configuration parameter</primary>
     </indexterm>
    </term>
________________________________________________________-->
    <term>
     <varname>basebackup_to_shell.command</varname> (<type>string</type>)
     <indexterm>
      <primary><varname>basebackup_to_shell.command</varname>配置参数</primary>
     </indexterm>
    </term>
<!-- pgdoc-cn_end sig_en=f1ba6020d37f05ba7c3dbc0c060a23d8 -->
    <listitem>
<!-- pgdoc-cn_start sig_en=888d7aee38187f40cf79496fc9f63c68 sig_cn_org=a4e2301aebc4a5efa530282ecfc0f837 source=15.7 
     <para>
      The command which the server should execute for each archive generated
      by the backup process. If <literal>%f</literal> occurs in the command
      string, it will be replaced by the name of the archive (e.g.
      <literal>base.tar</literal>). If <literal>%d</literal> occurs in the
      command string, it will be replaced by the target detail provided by
      the user. A target detail is required if <literal>%d</literal> is
      used in the command string, and prohibited otherwise. For security
      reasons, it may contain only alphanumeric characters. If
      <literal>%%</literal> occurs in the command string, it will be replaced
      by a single <literal>%</literal>. If <literal>%</literal> occurs in
      the command string followed by any other character or at the end of the
      string, an error occurs.
     </para>
________________________________________________________-->
     <para>
      服务器应该为备份过程生成的每个存档执行的命令。如果命令字符串中出现
      <literal>%f</literal>，它将被存档的名称替换（例如
      <literal>base.tar</literal>）。如果命令字符串中出现
      <literal>%d</literal>，它将被用户提供的目标详细信息替换。如果命令字符串中使用
      <literal>%d</literal>，则需要目标详细信息，否则禁止使用。出于安全原因，它只能包含字母数字字符。如果命令字符串中出现
      <literal>%%</literal>，它将被替换为一个单独的
      <literal>%</literal>。如果命令字符串中出现
      <literal>%</literal>，后面跟着任何其他字符或在字符串末尾，将会出现错误。
     </para>
<!-- pgdoc-cn_end sig_en=888d7aee38187f40cf79496fc9f63c68 -->
    </listitem>
   </varlistentry>

   <varlistentry>
<!-- pgdoc-cn_start sig_en=36a7eb9f80d9c65d43133535447f360a sig_cn_org=36a7eb9f80d9c65d43133535447f360a source=15.7 
    <term>
     <varname>basebackup_to_shell.required_role</varname> (<type>string</type>)
     <indexterm>
      <primary><varname>basebackup_to_shell.required_role</varname> configuration parameter</primary>
     </indexterm>
    </term>
________________________________________________________-->
    <term>
     <varname>basebackup_to_shell.required_role</varname> (<type>string</type>)
     <indexterm>
      <primary><varname>basebackup_to_shell.required_role</varname> configuration parameter</primary>
     </indexterm>
    </term>
<!-- pgdoc-cn_end sig_en=36a7eb9f80d9c65d43133535447f360a -->
    <listitem>
<!-- pgdoc-cn_start sig_en=b9b0b57adfb6fd1c3410b724f4da449e sig_cn_org=4527f4f21da75da0d07a5cd86bff36f4 source=15.7 
     <para>
      The role required in order to make use of the <literal>shell</literal>
      backup target. If this is not set, any replication user may make use of
      the <literal>shell</literal> backup target.
     </para>
________________________________________________________-->
     <para>
      使用<literal>shell</literal>备份目标所需的角色。如果未设置此项，任何复制用户都可以使用<literal>shell</literal>备份目标。
</para>
<!-- pgdoc-cn_end sig_en=b9b0b57adfb6fd1c3410b724f4da449e -->
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>

 <sect2>
<!-- pgdoc-cn_start sig_en=4cfae8ddf9b6dcc33177b633e0f1dcfc sig_cn_org=None source=14.1 
  <title>Author</title>
________________________________________________________-->
  <title>作者</title>
<!-- pgdoc-cn_end sig_en=4cfae8ddf9b6dcc33177b633e0f1dcfc -->

<!-- pgdoc-cn_start sig_en=4ee294b270614df2e3dc7112a9e81ba3 sig_cn_org=66c0970830bf9f34c646d0274ff23b12 source=15.7 
  <para>
   Robert Haas <email>rhaas@postgresql.org</email>
  </para>
________________________________________________________-->
  <para>
   Robert Haas <email>rhaas@postgresql.org</email>
</para>
<!-- pgdoc-cn_end sig_en=4ee294b270614df2e3dc7112a9e81ba3 -->
 </sect2>

</sect1>
